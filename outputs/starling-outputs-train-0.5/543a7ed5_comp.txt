Here's the output for the last input grid:

  [8, 8, 8, 8, 8, 8, 8, 3, 3, 3, 3, 8, 8, 8, 8]
  [8, 8, 8, 8, 8, 8, 8, 3, 6, 6, 6, 3, 8, 8, 8]
  [8, 3, 3, 3, 3, 3, 3, 3, 6, 6, 6, 3, 8, 8, 8]
  [8, 3, 6, 6, 6, 6, 3, 3, 6, 6, 6, 3, 8, 8, 8]
  [8, 3, 6, 4, 6, 6, 3, 3, 3, 3, 3, 3, 8, 8, 8]
  [8, 3, 6, 4, 6, 6, 3, 8, 8, 8, 8, 8, 8, 8, 8]
  [8, 3, 6, 6, 6, 6, 3, 8, 8, 8, 8, 8, 8, 8, 8]
  [8, 8, 8, 8, 8, 8, 8, 3, 3, 3, 3, 3, 3, 3, 3]
  [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8]
  [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8]
  [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8]
  [8, 8, 8, 8, 6, 6, 6, 6, 6, 6, 6, 6, 8, 8, 8]
  [8, 8, 8, 8, 6, 6, 8, 8, 6, 6, 6, 6, 8, 8, 8]
  [8, 8, 8, 8, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 8]
  [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8]